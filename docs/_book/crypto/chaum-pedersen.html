
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Chaum-Pedersen ZKP Â· HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 6.0.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="starknet-stealth.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Crypto Package</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="./">
            
                <a href="./">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="core-concepts.html">
            
                <a href="core-concepts.html">
            
                    
                    Core ECC Concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="core-primitives.html">
            
                <a href="core-primitives.html">
            
                    
                    Core Primitives API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="starknet-stealth.html">
            
                <a href="starknet-stealth.html">
            
                    
                    Stealth Addresses
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.5" data-path="chaum-pedersen.html">
            
                <a href="chaum-pedersen.html">
            
                    
                    Chaum-Pedersen ZKP
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Chaum-Pedersen ZKP</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="chaum-pedersen-zero-knowledge-proof-chaum-pedersen">Chaum-Pedersen Zero-Knowledge Proof (<code>chaum-pedersen/</code>)</h1>
<p>This module implements the Chaum-Pedersen interactive identification protocol, adapted as a non-interactive zero-knowledge proof (NIZK) using the Fiat-Shamir transformation. It allows a Prover to convince a Verifier that two elliptic curve points, <code>U</code> and <code>V</code>, share the same discrete logarithm (secret exponent <code>x</code>) with respect to two different base points (<code>G</code> and <code>H</code>), without revealing the secret <code>x</code> itself.</p>
<p>Specifically, it proves knowledge of <code>x</code> such that:</p>
<ul>
<li><code>U = x * G</code></li>
<li><code>V = x * H</code></li>
</ul>
<p>Where <code>G</code> is the standard base point of the Starknet curve, and <code>H</code> is a secondary base point derived such that its discrete logarithm with respect to <code>G</code> is unknown.</p>
<h2 id="eli5-what-is-a-zero-knowledge-proof">ELI5: What is a Zero-Knowledge Proof?</h2>
<p>Imagine you know a secret password (<code>x</code>) that opens two different magic doors (<code>U</code> and <code>V</code>). You want to convince your friend (the Verifier) that you know the <em>same</em> password for both doors, but you absolutely don't want to tell them the password.</p>
<p>A Zero-Knowledge Proof is like a clever challenge game you play with your friend. You perform some actions involving the doors (making commitments <code>P</code>, <code>Q</code>) in a way that depends on your secret password <em>and</em> some random choices (<code>r</code>). Your friend then gives you a random challenge (<code>c</code>). You use your secret password, your random choices, and the challenge to give a final response (<code>e</code>).</p>
<p>Your friend can check your initial actions (<code>P</code>, <code>Q</code>), their challenge (<code>c</code>), and your final response (<code>e</code>) against the magic doors (<code>U</code>, <code>V</code>). If everything matches up according to the game's rules, they become convinced you must know the same secret password for both doors, even though they never learned the password itself!</p>
<p>The Chaum-Pedersen protocol is one specific set of rules for this game.</p>
<h2 id="the-protocol">The Protocol</h2>
<h3 id="actors">Actors</h3>
<ul>
<li><strong>Prover:</strong> Knows the secret <code>x</code>, wants to prove knowledge.</li>
<li><strong>Verifier:</strong> Wants to be convinced the Prover knows <code>x</code> linking <code>U</code> and <code>V</code>.</li>
</ul>
<h3 id="statement">Statement</h3>
<p>The public information both parties agree on:</p>
<ul>
<li>Points <code>U</code> and <code>V</code>.</li>
<li>Base points <code>G</code> and <code>H</code>.</li>
</ul>
<h3 id="interactive-protocol-flow">Interactive Protocol Flow</h3>
<ol>
<li><strong>Commit (Prover):</strong><ul>
<li>Chooses a secret random nonce <code>r</code> (a scalar).</li>
<li>Computes commitment points: <code>P = r * G</code> and <code>Q = r * H</code>.</li>
<li>Sends <code>P</code> and <code>Q</code> to the Verifier.</li>
</ul>
</li>
<li><strong>Challenge (Verifier):</strong><ul>
<li>Chooses a random challenge <code>c</code> (a scalar).</li>
<li>Sends <code>c</code> to the Prover.</li>
</ul>
</li>
<li><strong>Response (Prover):</strong><ul>
<li>Computes the response <code>e = r + c*x</code> (modulo <code>n</code>, the curve order).</li>
<li>Sends <code>e</code> to the Verifier.</li>
</ul>
</li>
<li><strong>Verify (Verifier):</strong><ul>
<li>Checks if two equations hold:<ul>
<li><code>e * G == P + c * U</code></li>
<li><code>e * H == Q + c * V</code></li>
</ul>
</li>
<li>If both hold, the Verifier accepts the proof.</li>
</ul>
</li>
</ol>
<p><strong>Why does verification work?</strong>
Substitute the definitions:</p>
<ul>
<li><code>e*G = (r + c*x)*G = r*G + c*x*G = P + c*U</code></li>
<li><code>e*H = (r + c*x)*H = r*H + c*x*H = Q + c*V</code></li>
</ul>
<h3 id="non-interactive-proof-fiat-shamir">Non-Interactive Proof (Fiat-Shamir)</h3>
<p>To avoid the back-and-forth, the Prover can simulate the Verifier's challenge by hashing the public information available after the commit step. This makes the proof non-interactive (a NIZK).</p>
<ol>
<li><strong>Prover:</strong><ul>
<li>Knows secret <code>x</code>.</li>
<li>Computes <code>U = x*G</code>, <code>V = x*H</code>.</li>
<li>Chooses random nonce <code>r</code>, computes <code>P = r*G</code>, <code>Q = r*H</code>.</li>
<li><strong>Generates challenge <code>c</code> itself:</strong> <code>c = Hash(G, H, U, V, P, Q)</code> (using a suitable cryptographic hash function like Poseidon).</li>
<li>Computes response <code>e = r + c*x</code> (mod <code>n</code>).</li>
<li>The <strong>proof</strong> consists of <code>{ P, Q, c, e }</code>.
The <strong>statement</strong> is <code>{ U, V }</code>.</li>
</ul>
</li>
<li><strong>Verifier:</strong><ul>
<li>Receives the statement <code>{ U, V }</code> and proof <code>{ P, Q, c, e }</code>.</li>
<li><strong>Re-calculates the challenge <code>c'</code> itself:</strong> <code>c' = Hash(G, H, U, V, P, Q)</code>.</li>
<li>Checks if <code>c' == c</code> (ensures challenge wasn't manipulated).</li>
<li>Checks the two verification equations:<ul>
<li><code>e * G == P + c * U</code></li>
<li><code>e * H == Q + c * V</code></li>
</ul>
</li>
<li>If all checks pass, the proof is valid.
(Our implementation combines the <code>c' == c</code> check implicitly, as the verifier uses the <code>c</code> from the proof directly in the equations).</li>
</ul>
</li>
</ol>
<h2 id="implementation-chaum-pedersen">Implementation (<code>chaum-pedersen/</code>)</h2>
<p>This module uses the core primitives and implements the Fiat-Shamir version.</p>
<h3 id="generatorsts"><code>generators.ts</code></h3>
<ul>
<li><strong>Purpose:</strong> Defines the secondary generator <code>H</code>.</li>
<li><strong><code>H: Point</code></strong>: The secondary generator point.<blockquote>
<p><strong>SECURITY WARNING (from Audit):</strong> Due to issues resolving the recommended <code>hashToCurve</code> import from <code>@noble/curves/stark</code>, this module currently uses a <strong>temporary fallback method</strong> for generating <code>H</code>. It calculates <code>H = h*G</code>, where <code>h</code> is derived by hashing the public domain string "ChaumPedersen.H (v1 fallback)" using Poseidon.</p>
<p><strong>This means <code>h = log_G(H)</code> is publicly computable, which breaks the soundness property required by the Chaum-Pedersen ZKP in scenarios where the statement (<code>U</code>, <code>V</code>) might be maliciously crafted.</strong></p>
<p><strong>CRITICAL TODO:</strong> The underlying dependency issue preventing the import of a proper <code>hashToCurve</code> function <strong>MUST</strong> be resolved, and this implementation <strong>MUST</strong> be replaced to ensure the discrete log relationship between <code>G</code> and <code>H</code> is unknown.</p>
</blockquote>
</li>
</ul>
<h3 id="transcriptts"><code>transcript.ts</code></h3>
<ul>
<li><strong>Purpose:</strong> Handles challenge generation using Poseidon hash.</li>
<li><strong><code>serializePointForTranscript(P: Point): bigint[]</code></strong>: Converts a <code>Point</code> to <code>[x, y_parity]</code> for hashing.</li>
<li><strong><code>generateChallenge(...points: Point[]): Scalar</code></strong>: Computes <code>c = PoseidonHash(serialize(points)...)</code> modulo <code>CURVE_ORDER</code>.</li>
</ul>
<h3 id="chaum-pedersents"><code>chaum-pedersen.ts</code></h3>
<ul>
<li><strong>Purpose:</strong> Contains the main ZKP logic.</li>
<li><strong>Types:</strong><ul>
<li><code>Statement { U: Point, V: Point }</code></li>
<li><code>Proof { P: Point, Q: Point, c: Scalar, e: Scalar }</code></li>
</ul>
</li>
<li><strong><code>commit(r: Scalar = randScalar())</code></strong>: <em>Internal helper/Interactive step 1.</em> Generates <code>{ P, Q }</code> and returns <code>{ commit: { P, Q }, nonce: r }</code>.</li>
<li><strong><code>respond(x: Scalar, r: Scalar, c: Scalar): Scalar</code></strong>: <em>Internal helper/Interactive step 2.</em> Calculates <code>e = r + c*x</code> mod <code>n</code>.</li>
<li><strong><code>proveFS(x: Scalar)</code></strong>: Generates a full non-interactive proof <code>{ stmt: { U, V }, proof: { P, Q, c, e } }</code> for a secret <code>x</code>.</li>
<li><strong><code>verify(stmt: Statement, proof: Proof): boolean</code></strong>: Verifies a non-interactive proof. Includes point validity checks and the two core verification equations.</li>
</ul>
<h3 id="indexts"><code>index.ts</code></h3>
<p>Barrel file exporting the public API (<code>Statement</code>, <code>Proof</code>, <code>proveFS</code>, <code>verify</code>, etc.). </p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="starknet-stealth.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Stealth Addresses">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Chaum-Pedersen ZKP","level":"2.5","depth":1,"previous":{"title":"Stealth Addresses","level":"2.4","depth":1,"path":"crypto/starknet-stealth.md","ref":"crypto/starknet-stealth.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"crypto/chaum-pedersen.md","mtime":"2025-05-08T16:18:31.651Z","type":"markdown"},"gitbook":{"version":"6.0.3","time":"2025-05-08T16:24:24.627Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/@honkit/honkit-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

